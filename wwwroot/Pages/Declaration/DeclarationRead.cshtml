@page
@using Difi.Sjalvdeklaration.Shared.Classes.Declaration.Data
@using Difi.Sjalvdeklaration.Shared.Enum
@model wwwroot.Pages.Declaration.DeclarationReadModel

@{
    var title = "Egenkontroll - Läsa";

    ViewData["Title"] = title;

    var mainIndex = 1;
}

@Html.DisplayFor(x => x.DeclarationItemForm, "DeclarationStatus", new { backUrl = "/Declaration/DeclarationForm?id=" + Model.DeclarationItemForm.Id })

<main>
    <div class="row">
        <div class="xlarge-12 large-10 small-12 large-centered xlarge-uncentered columns">

            @Html.DisplayFor(x => x.DeclarationItemForm, "DeclarationReadStep1", new { mainIndex, allDone = @Model.AllDoneStep1 })

            @foreach (var declarationIndicatorGroup in Model.TestGroupItemList)
            {
                mainIndex++;
                @Html.DisplayFor(x => declarationIndicatorGroup, "DeclarationReadTestGroup", new { mainIndex, declarationItem = Model.DeclarationItemForm, viewResult = false })
            }

            <br />

            <div class="row collapse align-bottom hide-for-print">
                @if (Model.DeclarationItemForm.DeclarationTestItem.StatusCount != 4)
                {
                    <div class="small-12 columns">
                        <p>For å kunne sende inn, må du først fullføre egenkontrollen ved å svare på alle spørsmålene.</p>
                    </div>
                }

                <div class="small-12 columns">
                    @if (Model.DeclarationItemForm.DeclarationTestItem.StatusCount == 4)
                    {
                        <form method="post">
                            <a asp-page="/Declaration/DeclarationForm" class="button alt" asp-route-id="@Model.DeclarationItemForm.Id">@Localizer["Back"]</a>
                            <button class="button large" type="submit" asp-page-handler="SendIn" asp-route-id="@Model.DeclarationItemForm.Id">@Localizer["Send"]</button>
                        </form>
                    }
                    else
                    {
                        <a asp-page="/Declaration/DeclarationForm" class="button alt" asp-route-id="@Model.DeclarationItemForm.Id">@Localizer["Back"]</a>
                    }
                </div>

                <div class="small-12 columns">
                    <br />
                    <button class="button print jsPrintButton" asp-route-id="@Model.DeclarationItemForm.Id">@Localizer["Print"]</button>
                </div>
            </div>
            <br /><br />
        </div>
    </div>
</main>